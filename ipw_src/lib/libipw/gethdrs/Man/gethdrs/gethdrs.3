.TH "gethdrs" "3" "30 January 2017" "IPW v2" "IPW Library Functions"
.SH NAME
.PP
\fBgethdrs\fP - process IPW image headers
.SH SYNOPSIS
.sp
.nf
.ft CR
#include "gethdrs.h"

void
gethdrs(
	int             fdi,	  |* input image file descriptor  *|
	GETHDR_T      **request,  |* -> header requests		  *|
	int             nbands,	  |* # bands in output image	  *|
	int             fdo)	  |* output image file descriptor *|

.ft R
.fi
.SH DESCRIPTION
.PP
\fBgethdrs\fP provides a high-level interface to the IPW "hdrio" routines.
Image headers are read from file descriptor fdi and, subject to the
interpretation of request, written to file descriptor fdo.
.PP
request points to an array of pointers to GETHDR_T structures.  The
last element in the array must be a NULL pointer.
.PP
Each GETHDR_T structure specifies the disposition of a particular
type of IPW header.  The first two fields of the structure should be
initialized to the name of the IPW header to be processed, and a
pointer to the header's ingest routine.  If the ingest routine pointer
is NULL, then the header will be skipped; otherwise, the header will
be ingested and its address will be available via the hdr_addr macro
when \fBgethdrs\fP returns.
.PP
Headers that are not mentioned in the structures pointed to via
request, and that pertain to band numbers less than nbands, are
copied to file descriptor fdo.  You must therefore read the BIH from
fdi, and write a BIH to fdo, before calling \fBgethdrs\fP.
.PP
nbands == NO_COPY prevents any header output by \fBgethdrs\fP.
.PP
The following example will hopefully make this a little clearer:
.sp
.nf
.ft CR
	static GETHDR_T h_lqh = {LQH_HNAME, (ingest_t)lqhread};
	static GETHDR_T h_orh = {ORH_HNAME};
	static GETHDR_T *request[] = {&h_lqh, &h_orh, NULL};
	...
	i_bihpp = bihread(i_fd);
	...
	bihwrite(o_fd, o_bihpp);
	gethdrs(i_fd, request, bih_nbands(o_bihpp), o_fd);
	i_lqhpp = (LQH_T **) hdr_addr(h_lqh);
	...
	lqhwrite(o_fd, o_lqhpp);
	boimage(o_fd);
.ft R
.fi

.PP
In this code fragment, we have arranged to ingest a LQ header, skip
an ORH header, and copy any other headers encountered to fdo.  Note
that we must explicity write a LQ header if we want one to be placed
in the output image -- ingested headers are NOT copied.
.SH RETURN VALUE
.PP
None.
.SH EXAMPLES
.SH GLOBALS ACCESSED
.PP
None.
.SH DIAGNOSTICS
.sp
.TP
can't copy \fIheader-name\fP header
can't skip \fIheader-name\fP header
can't ingest \fIheader-name\fP header
header read error
.SH RESTRICTIONS
.PP
None.
.SH HISTORY
.SH BUGS
.PP
None.
.SH SEE ALSO
