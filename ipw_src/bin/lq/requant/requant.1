.TH "requant" "1" "30 January 2017" "IPW v2" "IPW User Commands"
.SH NAME
.PP
\fBrequant\fP - modify the linear quantization of an IPW image
.SH SYNOPSIS
.sp
.nf
.ft CR
\fBrequant\fP [ \fB-h\fP \fIlqh\fP ] [ \fB-m\fP \fIlo\fP,\fIhi\fP ] [ \fB-b\fP \fIbits\fP ] [ \fB-v\fP ] \fIimage\fP
.ft R
.fi
.SH DESCRIPTION
.PP
\fBrequant\fP changes the linear quantization header of an IPW image to
that specified by a given "lq" header \fIlqh\fP, or with low and high
values (\fIlo\fP and \fIhi\fP), or to a given number of bits \fIbits\fP.
.PP
If a "lq" header is supplied with the \fB-h option, the \fB-m and \fB-b options
are not valid, as that information is contained within the "lq" header.
If a multi-band image is given as input, and the \fB-m or \fB-b option is
used, all the bands will have the specified quantization change
applied.
.SH OPTIONS
.TP
\fB-h\fP \fIlqh\fP
Use \fIlqh\fP as the new linear quantization header.
.sp
.TP
\fB-m\fP \fIlo\fP,\fIhi\fP
\fIlo\fP and \fIhi\fP will be the low and high floating point values
for the new LQH.
.sp
.TP
\fB-b\fP \fIbits\fP
The requantized image will use \fIbits\fP bits per pixel.
.PP
If \fB-h is specified, the \fB-m and \fB-b options may not be used.
.TP
\fB-v\fP
Print a text version of the "lq" headers before and after
remapping on the standard error.
.SH OPERANDS
.TP
\fIimage\fP
	image
.sp
.SH EXAMPLES
.PP
Given a 12-bit image "elev", an 8-bit image can be obtained:
.sp
.nf
.ft CR
	requant -b 8  elev
.ft R
.fi

.PP
After processing, an NDVI image may have values ranging from -0.3
to 0.7.  To obtain a standard -1.0 to 1.0 mapping:
.sp
.nf
.ft CR
	requant -m -1,1
.ft R
.fi

.PP
If multiple images need to have the same lqh, the program lqmm
can be used to find the minimum and maximum of all the images,
followed by a loop to requantize each image.  In the C-Shell, this
could be used to give the images 'img*' all the same LQH:
.sp
.nf
.ft CR
	set minmax=`lqmm img*`
	foreach image (img*)
		requant -m $minmax[1],$minmax[2] $image > $image.req
	end
.ft R
.fi
.SH FILES
.PP
None
.SH DIAGNOSTICS
.sp
.TP
No LQ header on output image -- copying image
.br
	No linear quantization header was found in the input image,
	nor was one given with the \fB-h option, so a simple copy of
	the image data was done.
.sp
.TP
\fIbits\fP bits does not permit \fIbkpts\fP breakpoints
.br
	The image has multiple breakpoints, and the new quantization
	does not have enough bits to fit them all.  Either raise the
	number of bits, or use the \fB-m option to throw out all the
	breakpoints.
.sp
.TP
can't use both an LQH header and \fIopt\fP option
.br
	When a seperate linear quantization header is given, it has
	all the information needed to requantize the image.  The \fB-m
	and/or \fB-b options would be redundant.
.sp
.TP
input image and LQH file have different # bands
.br
	The input image and the given "lq" header must have the same
	number of bands, as each band can have different quantizations.
.sp
.TP
error during LQH header remap of band \fIband\fP
.br
	Something has gone wrong during the remap of the "lq" headers
	to a different number of bits.  Use the \fB-v option to attempt
	to determine the cause.
.sp
.TP
binary search not yet implemented
.br
	The IPW library being used has not had the binary search
	implemented, so will need to be updated.  See the Restrictions
	section for more information on this.
.SH RESTRICTIONS
.PP
If requantization of bits is done without changing the low and high
LQ values, the breakpoints are preserved.  This is usually what is
desired, but is different than the behavior of requantize which threw
away any special "lq" headers.  This also will only work with the fixed
IPW fpio library routine, which were corrected at the time this was
written.
.SH HISTORY
.TP
Jul 1990
	Program "requantize" written by Kelly Longley, ERL-C
.TP
Aug 1993
	Re-written as "\fBrequant\fP", by Dana Jacobsen, ERL-C.
Program description based on pgm "requantize";
Much of the \fBrequant\fP code based on lqhx in the base IPW
programs, by Jim Frew (1990) of UCSB.
.TP
Aug 1997
	Converted to IPW Version 2.0, D. Marks, USGS, ERL-C
.SH BUGS
.PP
None
.SH SEE ALSO
.TP
IPW
	\fBlqhx\fP,
\fBlutx\fP,
\fBinterp\fP,
\fBmklut\fP,
\fBlqmm\fP
