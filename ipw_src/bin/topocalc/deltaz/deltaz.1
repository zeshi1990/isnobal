.TH "deltaz" "1" "30 January 2017" "IPW v2" "IPW User Commands"
.SH NAME
.PP
\fBdeltaz\fP - differences from mean-weighted station elevations
.SH SYNOPSIS
.sp
.nf
.ft CR
\fBdeltaz\fP [ \fB-n\fP \fInpoints\fP ] [ \fB-d\fP \fIdem_image\fP ] [ \fB-p\fP \fIinfile\fP ]
      [ \fB-b\fP \fIbits\fP ]
.ft R
.fi
.SH DESCRIPTION
.PP
\fBdeltaz\fP reads a DEM image and an ASCII file of station data points
(easting northing elevation).  The output image contains \fBdeltaz\fP
values, where \fBdeltaz\fP is the DEM elevation minus the weighted-mean
station elevation.  The weighted-mean station elevation is
computed by inverse-distance-squared weighting based on the \fInpoints\fP
nearest station points.
.PP
The purpose of the \fBdeltaz\fP measure is to quantitatively flag regions
which may be susceptible to interpolation error when station data are
used to estimate the distributions of elevation-sensitive parameters
(such as temperature, precipitation, or humidity).
Large positive (negative) values of \fBdeltaz\fP indicate grid
cells which are much higher (lower) than the weighted mean elevation
of the \fInpoints\fP nearest measurement stations.  Large \fBdeltaz\fP values
indicate that station information will be extrapolated far beyond
the elevational range of the local measurement stations
(see Dodson and Marks, 1997).
.PP
If you wish to use a mask image to define an area of interest,
add the mask as a second band to \fIdem_image\fP.  (Use the mux command.)
.SH OPTIONS
.TP
\fB-d\fP \fIdem_image\fP
The DEM image to be used for calculations.  This image
defines the geodetic extent of the output image.
An optional second band can be added to \fIdem_image\fP
if a mask is desired.  Cells with zero values in the
mask band will be given an output value of zero.
.sp
.TP
\fB-n\fP \fInpoints\fP
The number of nearest neighbors used for interpolation will
be \fInpoints\fP (default: 12).
.sp
.TP
\fB-p\fP \fIinfile\fP
Points will be read in from \fIinfile\fP (default: standard input).
The input file contains three values per line, formatted:
.sp
easting  northing  elevation
.sp
where the easting and northing are specified in the same
coordinate system as given in the "geo" header.
.sp
.TP
\fB-b\fP \fIbits\fP
The output image will have \fIbits\fP bits of LQ precision.
(default: 8)
.sp
NOTE:   use lots of lqh precision, as the LQ header min/max values
are currently taken from the deltaZ values computed using
DEM and station extrema, rather than the range of deltaZ
values which actually occur.  (see 'future directions' below)
.SH OPERANDS
.PP
None.
.SH EXAMPLES
.PP
The file "pts_ll" contains longitude, latitude, and elevation
for a set of climatological stations.  The images "dem" and "mask"
pertain to the region defined by "pts_ll", but on an Albers
map projection.  First convert the station locations to
Albers coordinates:
.sp
.nf
.ft CR
	transcoord -i geo.defs -o albers.defs pts_ll > pts_alb
.ft R
.fi

.PP
Then to calculate \fBdeltaz\fP over a masked area within the DEM image,
using the nearest 4 measurement stations:
.sp
.nf
.ft CR
	mux dem mask | deltaz -n 4 -p pts_alb > dZ_image
.ft R
.fi
.SH FILES
.sp
.nf
.ft CR
     None
.ft R
.fi
.SH DIAGNOSTICS
.sp
.TP
error reading point \fInpoint\fP from input file
.sp
.TP
input header has no geodetic header
.br
	The input header file must have a GEO header.
.sp
.TP
input geo units are degrees - must be Euclidean units
.br
	The geodetic coordinates defined in the input header
         	must be appropriate for Euclidean distance calculations:
         		d = sqrt( (x1-x2)^2 + (y1-y2)^2 )
.SH RESTRICTIONS
.PP
The dem image may not have more than two bands.
.SH HISTORY
.TP
Dec 1994
	Written by Rusty Dodson, MERSC, ERL-C.
.SH BUGS
.PP
LQ precision can be very grainy when \fIbits\fP is low.  See
Future Directions above.
.SH SEE ALSO
.TP
IPW
	\fBmkbih\fP,
\fBmkgeoh\fP,
\fBmkproj\fP,
\fBmux\fP,
\fBreproj\fP,
\fBtranscoord\fP
.PP
Dodson, R., and D. Marks, 1997. "Daily air temperature interpolated
at high spatial resolution over a large mountainous region", Climate
Research, vol. 8, pp. 1-20.
