.TH "soiltmp" "1" "30 January 2017" "IPW v2" "IPW User Commands"
.SH NAME
.PP
\fBsoiltmp\fP - soil layer temperature from min & max air temperatures
.SH SYNOPSIS
.sp
.nf
.ft CR
\fBsoiltmp\fP
.ft R
.fi
.SH DESCRIPTION
.PP
\fBsoiltmp\fP calculates soil layer temperature using a sin-wave
function where the amplitude of the wave is computed
as a proportion of the difference between the maximum and minimum
air temperature for the period, and the mean is the average
soil layer temperature. Program was designed to compute
soil layer temperatures at specified intervals
based on daily, weekly, or annual temperature information readily
available from surface meteorologic station info.
Average layer temperature can be from infrequent spot measurements
or estimated as and offset from average air temp ((Tmax + Tmin)/2);
Period must be complete cycle (eg. 24 hrs, 52 weeks, 12 mo etc,);
Amplitude damping is difference between air temp amplitude, and soil
layer temp amplitude over period, and can be estimated from
SD(soil_temp)/SD(air_temp) over the period.  (eg. 1.0 for surface
layer, 0.8 for layer 15cm deep, 0.5 for layer 1m deep, 0 for layer
2m deep, etc.)
.PP
Reads input file from stdin:
.sp
.nf
.ft CR
       Ta_max, Ta_min, Tg_avg, Period, Ta_lag, Tg_lag, damp
.ft R
.fi

.PP
Where:
.sp
.nf
.ft CR
    Tmax    = maximum daily air temp. (C)
    Tmin    = minimum daily air temp. (C)
    Tg_avg  = average soil layer temp. (C)
    Period  = wave period (24 hours, 52 weeks, 12 months, etc.)
    Ta_lag  = time of maximum air temperature (in Period units)
    Tg_lag  = time of maximum soil layer temperature (in Period units)
    damp    = amplitude damping (1.0 for none to 0.0 for constant value)
.ft R
.fi
.PP
Outputs one record per interval over the period to stdout:
.sp
.nf
.ft CR
                 fn(Ta), Ta, fn(Tg), Tg
.ft R
.fi
.SH OPTIONS
.PP
none
.SH OPERANDS
.PP
none
.SH EXAMPLES
.PP
To estimate hourly air and soil temperature from max-min air temperature,
and average soil temperature, where:
.sp
.nf
.ft CR
                   Tmax     = 12
                   Tmin     = 3
                   Tg_avg   = 4
                   Period   = 24 hrs
                   Ta_lag   = 16 hrs (4PM)
                   Tg_lag   = 6 hrs (6pm)
                   damp     = 0.8
.ft R
.fi
.sp
.nf
.ft CR
	soiltmp < {12 3 4 24 16 18 0.8}
.ft R
.fi

.PP
produces:
.sp
.nf
.ft CR
	time	f(ta)		ta	f(tg)		tg
	====================================================
	1	-0.707107	4.32	-0.258819	3.07
	2	-0.866025	3.60	-0.500000	2.20
	3	-0.965926	3.15	-0.707107	1.45
	4	-1.000000	3.00	-0.866025	0.88
	5	-0.965926	3.15	-0.965926	0.52
	6	-0.866025	3.60	-1.000000	0.40
	7	-0.707107	4.32	-0.965926	0.52
	8	-0.500000	5.25	-0.866025	0.88
	9	-0.258819	6.34	-0.707107	1.45
	10	0.000000	7.50	-0.500000	2.20
	11	0.258819	8.66	-0.258819	3.07
	12	0.500000	9.75	0.000000	4.00
	13	0.707107	10.68	0.258819	4.93
	14	0.866025	11.40	0.500000	5.80
	15	0.965926	11.85	0.707107	6.55
	16	1.000000	12.00	0.866025	7.12
	17	0.965926	11.85	0.965926	7.48
	18	0.866025	11.40	1.000000	7.60
	19	0.707107	10.68	0.965926	7.48
	20	0.500000	9.75	0.866025	7.12
	21	0.258819	8.66	0.707107	6.55
	22	0.000000	7.50	0.500000	5.80
	23	-0.258819	6.34	0.258819	4.93
	24	-0.500000	5.25	0.000000	4.00
.ft R
.fi
.SH FILES
.PP
none
.SH DIAGNOSTICS
.PP
none
.SH RESTRICTIONS
.PP
none
.SH HISTORY
.TP
May 1996
Converted from IPW command \fBsurftmp\fP to a more general form
to handle both diurnal and annual periods, output
entire period, and deal with arbitrary soil depth,
and layor thickness, by D. Marks, USGS, ERL-C.
.SH BUGS
.PP
none
.SH SEE ALSO
.TP
IPW:
	\fBalbedo\fP,
\fBbowvap\fP,
\fBdewpt\fP,
\fBgsnow\fP,
\fBmse\fP,
\fBpenmonx\fP,
\fBpmx\fP,
\fBpott\fP,
\fBptaylorx\fP,
\fBptx\fP,
\fBrh2vp\fP,
\fBsatvp\fP,
\fBsling\fP,
\fBsoilt\fP,
\fBsrftmp\fP,
\fBswe\fP,
\fBswp\fP,
\fBthermin\fP,
\fBtrad\fP,
\fBtrb_Ri\fP,
\fBtrbxfr\fP,
\fBvptr\fP,
\fBzpr\fP
.PP
Jury, Gardner 1991
